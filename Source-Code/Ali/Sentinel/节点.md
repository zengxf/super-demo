## 作用
- 保存资源的实时统计信息


## 类结构
- `com.alibaba.csp.sentinel.slots.statistic.metric.DebugSupport`
```java
/** 调试支持 */
public interface DebugSupport {
    void debug();   // 打印统计信息
}
```

- `com.alibaba.csp.sentinel.node.OccupySupport`
```java
/** 占用支持 */
public interface OccupySupport {
    ...
}
```

- `com.alibaba.csp.sentinel.node.Node`
```java
/** 节点 (用于统计) */
public interface Node extends OccupySupport, DebugSupport {
    long totalRequest();    // 获取每分钟传入的请求
    long totalPass();       // 获取每分钟的通过次数
    long totalSuccess();    // 每分钟完成的请求(Entry.exit())总数
    long blockRequest();    // 获取每分钟阻止的请求计数
    long totalException();  // 获取每分钟的异常计数
    double passQps();       // 获取每秒已通过请求的 QPS
    double blockQps();      // 获取每秒被阻止请求的 QPS
    double totalQps();      // 获取每秒总请求的 QPS
    double successQps();    // 获取每秒已完成请求的(Entry.exit()) QPS
    double maxSuccessQps(); // 获得最大已完成请求的 QPS
    double exceptionQps();  // 发生异常的 QPS
    double avgRt();         // 平均每秒响应时间 (Rt: response time)
    double minRt();
    int curThreadNum();
    double previousBlockQps();
    double previousPassQps();
    void addPassRequest(int count);
    void addRtAndSuccess(long rt, int success);
    void increaseBlockQps(int count);
    void increaseExceptionQps(int count);
    void increaseThreadNum();
    void decreaseThreadNum();
    void reset();
}
```

- `com.alibaba.csp.sentinel.node.StatisticNode`
```java
/** 统计节点 */
public class StatisticNode implements Node {
    // 保存最近 INTERVAL(1000) 毫秒的统计信息。
    // 节点的统计逻辑都委派给其处理
    private transient volatile Metric rollingCounterInSecond = new ArrayMetric(
        SampleCountProperty.SAMPLE_COUNT,   // def: 2
        IntervalProperty.INTERVAL           // def: 1000
    );
    // 保存最近 60 秒的统计信息。
    // 节点的统计逻辑都委派给其处理
    private transient Metric rollingCounterInMinute = new ArrayMetric(60, 60 * 1000, false);
    private LongAdder curThreadNum = new LongAdder();
    private long lastFetchTime = -1;
}
```

- `com.alibaba.csp.sentinel.node.DefaultNode`
```java
/** 默认节点 */
public class DefaultNode extends StatisticNode {
    private ResourceWrapper id;         // 关联的资源 (标识)
    private volatile Set<Node> childList = new HashSet<>(); // 子节点集
    private ClusterNode clusterNode;    // 关联的群集节点。
}
```

- `com.alibaba.csp.sentinel.node.EntranceNode`
```java
/** 入口节点 */
public class EntranceNode extends DefaultNode {
    ... // 只是根据所有的子节点进行计算统计结果
}
```

- `com.alibaba.csp.sentinel.node.ClusterNode`
```java
/** 集群节点 */
public class ClusterNode extends StatisticNode {
    private final String name;          // 名称
    private final int resourceType;     // 资源类型 (0: COMMON; 1: WEB; 2: RPC; 3: ApiGateway; 4: DB)
    private Map<String, StatisticNode> originCountMap = new HashMap<>(); // 保存不同来源的 StatisticNode
    private final ReentrantLock lock = new ReentrantLock(); // 操作 originCountMap 的 DCL 锁
}
```